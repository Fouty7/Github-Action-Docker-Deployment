---
- name: configuration play 
  hosts: web
  user: ubuntu
  become: true
  become_method: sudo
  gather_facts: false
  tasks:

  - name: copy files
    copy:
      src: ./
      dest: github/

  - name: start docker compose
    become: yes
    shell: |
      cd github
      docker image ls
      docker compose up -d --build

  #- name: cleanup old images
  #  become: yes
  #  shell: docker rmi $(docker images --filter "dangling=true" -q --no-trunc)